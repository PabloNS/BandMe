<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
<head>
<title>BandMe</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" th:href="@{/css/skeleton.css}" />
<link rel="stylesheet" type="text/css" th:href="@{/css/myCss.css}" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
</head>
<body>
	<div class="container">
		<div class="row">
			<div class="offset-by-three one-half column"
				style="margin-top: 20%; box-shadow: 0 2px 10px #606060; padding: 3rem; padding-bottom: 1rem; border-radius: 1rem">
				<form th:action="@{/posts}" th:object="${post}" method="post" class="u-full-width" style="margin-top: 2rem">
					<label for="instruments">Instrument</label> 
					<input type="hidden" id="instrumentInput" name="instrument" required th:field="*{instrument}" >
					<select id="instruments" required name="instrumentSelect" class="u-full-width">
						<option>Select instrument</option>
					</select>
					<label th:if="${#fields.hasErrors('instrument')}" th:errors="*{instrument}" class="validation-message"></label>
					
					<label for="descriptionInput">Description</label>
					<textarea id="descriptionInput" maxlength="1400" name="description"
						class="u-full-width" style="resize: none; height: 250px" th:field="*{description}"></textarea>
					<label th:if="${#fields.hasErrors('description')}" th:errors="*{description}" class="validation-message"></label>
					
					<button class="button-primary u-full-width" type="submit">AddPost</button>
				</form>
			</div>
		</div>
	</div>
	<script>
		function loadInstruments() {
			$.ajax({
		        type: 'GET',
		        url: '/instruments',
		        cache: false,
		        success: function (result) {
		        	var combo = document.getElementById("instruments");
		        	result.forEach(function(instrument){
					    var option = document.createElement("option");
					    option.text = instrument.name;
					    option.value = instrument.id;
					    combo.add(option);
		        	});
		        }
		    });
		}
		var combo = document.getElementById("instruments");
		combo.onchange = function(event){
			var instrument = document.getElementById("instrumentInput");
			instrument.value = event.target.value;
		}
		loadInstruments();
	</script>
</body>
</html>